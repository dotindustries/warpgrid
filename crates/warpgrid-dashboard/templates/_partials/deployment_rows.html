<table class="w-full text-sm">
  <thead>
    <tr class="border-b border-slate-700 text-slate-400 text-left">
      <th class="px-4 py-2.5 font-medium">Name</th>
      <th class="px-4 py-2.5 font-medium">Namespace</th>
      <th class="px-4 py-2.5 font-medium">Trigger</th>
      <th class="px-4 py-2.5 font-medium">Instances</th>
      <th class="px-4 py-2.5 font-medium">Health</th>
      <th class="px-4 py-2.5 font-medium">RPS</th>
      <th class="px-4 py-2.5 font-medium">Error %</th>
      <th class="px-4 py-2.5 font-medium">Shims</th>
      <th class="px-4 py-2.5 font-medium">Memory</th>
    </tr>
  </thead>
  <tbody>
    {% for d in deployments %}
    <tr class="border-b border-slate-700/50 hover:bg-slate-700/30">
      <td class="px-4 py-2.5">
        <a href="/dashboard/deployments/{{ d.id }}" class="text-emerald-400 hover:underline font-mono">{{ d.name }}</a>
      </td>
      <td class="px-4 py-2.5">
        <span class="px-2 py-0.5 bg-slate-700 rounded text-xs font-mono">{{ d.namespace }}</span>
      </td>
      <td class="px-4 py-2.5 font-mono text-sm text-slate-300">
        <span class="text-xs px-1.5 py-0.5 bg-slate-700 rounded mr-1">{{ d.trigger_icon }}</span>
        {{ d.trigger_display }}
      </td>
      <td class="px-4 py-2.5 font-mono">
        <div class="flex items-center gap-2">
          <span class="text-emerald-400">{{ d.instances_running }}</span><span class="text-slate-500">/{{ d.instances_max }}</span>
          <div class="w-12 bg-slate-700 rounded-full h-1.5">
            <div class="bg-emerald-400 h-1.5 rounded-full" style="width: {{ d.instance_percent_display }}%"></div>
          </div>
        </div>
      </td>
      <td class="px-4 py-2.5">
        <div class="flex gap-1">
          {% for dot in d.health_dots %}
          <span class="w-2 h-2 rounded-full {{ dot.color }}" title="{{ dot.title }}"></span>
          {% endfor %}
        </div>
      </td>
      <td class="px-4 py-2.5 font-mono text-sm">
        {% match d.latest_rps_display %}
          {% when Some with (rps) %}{{ rps }}{% when None %}<span class="text-slate-500">—</span>{% endmatch %}
      </td>
      <td class="px-4 py-2.5 font-mono text-sm {{ d.error_rate_color }}">
        {% match d.error_rate_display %}
          {% when Some with (rate) %}{{ rate }}%{% when None %}<span class="text-slate-500">—</span>{% endmatch %}
      </td>
      <td class="px-4 py-2.5">
        <div class="flex gap-1">
          {% if d.shims.timezone %}<span class="text-xs px-1 bg-slate-700 rounded text-slate-400" title="Timezone">TZ</span>{% endif %}
          {% if d.shims.dev_urandom %}<span class="text-xs px-1 bg-slate-700 rounded text-slate-400" title="Random">RNG</span>{% endif %}
          {% if d.shims.dns %}<span class="text-xs px-1 bg-slate-700 rounded text-slate-400" title="DNS">DNS</span>{% endif %}
          {% if d.shims.signals %}<span class="text-xs px-1 bg-slate-700 rounded text-slate-400" title="Signals">SIG</span>{% endif %}
          {% if d.shims.database_proxy %}<span class="text-xs px-1 bg-slate-700 rounded text-slate-400" title="Database">DB</span>{% endif %}
        </div>
      </td>
      <td class="px-4 py-2.5 font-mono text-sm text-slate-300">{{ d.memory_display }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
