<!-- Density Demo Comparison Cards â€” polled by HTMX when deployed -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-10">
  <!-- Memory -->
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <div class="flex items-center gap-2 mb-3">
      <span class="w-2 h-2 rounded-full bg-grid-accent glow-green"></span>
      <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Memory</span>
      {% if demo.is_deployed %}
      <span class="ml-auto inline-flex items-center gap-1 text-[10px] font-mono text-emerald-400 bg-emerald-500/10 border border-emerald-500/20 rounded-full px-1.5 py-0.5">
        <span class="w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"></span>LIVE
      </span>
      {% endif %}
    </div>
    <div class="space-y-2">
      <div class="flex items-baseline gap-2">
        <span class="text-2xl font-display font-bold text-grid-accent">{% if demo.is_deployed %}{{ demo.live_total_memory }}{% else %}{{ demo.wasm_memory_display }}{% endif %}</span>
        <span class="text-xs text-slate-500">WarpGrid</span>
      </div>
      <div class="flex items-baseline gap-2">
        <span class="text-lg font-display text-slate-400">{{ demo.docker_memory_display }}</span>
        <span class="text-xs text-slate-500">Docker</span>
      </div>
      <div class="pt-2 border-t border-grid-700/30">
        <span class="text-sm font-mono text-grid-accent font-medium">{{ demo.memory_ratio }}</span>
        <span class="text-xs text-slate-500 ml-1">({{ demo.wasm_memory_per_instance }} vs {{ demo.docker_memory_per_instance }} per instance)</span>
      </div>
    </div>
  </div>

  <!-- Startup Time -->
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <div class="flex items-center gap-2 mb-3">
      <span class="w-2 h-2 rounded-full bg-grid-info glow-blue"></span>
      <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Startup</span>
    </div>
    <div class="space-y-2">
      <div class="flex items-baseline gap-2">
        <span class="text-2xl font-display font-bold text-grid-info">{{ demo.wasm_startup_display }}</span>
        <span class="text-xs text-slate-500">WarpGrid</span>
      </div>
      <div class="flex items-baseline gap-2">
        <span class="text-lg font-display text-slate-400">{{ demo.docker_startup_display }}</span>
        <span class="text-xs text-slate-500">Docker</span>
      </div>
      <div class="pt-2 border-t border-grid-700/30">
        <span class="text-sm font-mono text-grid-info font-medium">{{ demo.startup_ratio }}</span>
        <span class="text-xs text-slate-500 ml-1">cold start to first request</span>
      </div>
    </div>
  </div>

  <!-- Connections -->
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <div class="flex items-center gap-2 mb-3">
      <span class="w-2 h-2 rounded-full bg-grid-warn glow-amber"></span>
      <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">PG Connections</span>
    </div>
    <div class="space-y-2">
      <div class="flex items-baseline gap-2">
        <span class="text-2xl font-display font-bold text-grid-warn">{{ demo.wasm_connections_display }}</span>
        <span class="text-xs text-slate-500">WarpGrid (shared pool)</span>
      </div>
      <div class="flex items-baseline gap-2">
        <span class="text-lg font-display text-slate-400">{{ demo.docker_connections_display }}</span>
        <span class="text-xs text-slate-500">Docker (per-container)</span>
      </div>
      <div class="pt-2 border-t border-grid-700/30">
        <span class="text-sm font-mono text-grid-warn font-medium">{{ demo.connection_ratio }}</span>
        <span class="text-xs text-slate-500 ml-1">connections to PostgreSQL</span>
      </div>
    </div>
  </div>

  <!-- Binary Size -->
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <div class="flex items-center gap-2 mb-3">
      <span class="w-2 h-2 rounded-full bg-purple-400" style="box-shadow: 0 0 6px rgba(192,132,252,0.5);"></span>
      <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Binary Size</span>
    </div>
    <div class="space-y-2">
      <div class="flex items-baseline gap-2">
        <span class="text-2xl font-display font-bold text-purple-400">{{ demo.wasm_binary_display }}</span>
        <span class="text-xs text-slate-500">Wasm component</span>
      </div>
      <div class="flex items-baseline gap-2">
        <span class="text-lg font-display text-slate-400">{{ demo.docker_binary_display }}</span>
        <span class="text-xs text-slate-500">Docker image</span>
      </div>
      <div class="pt-2 border-t border-grid-700/30">
        <span class="text-sm font-mono text-purple-400 font-medium">{{ demo.binary_ratio }}</span>
        <span class="text-xs text-slate-500 ml-1">image/component size</span>
      </div>
    </div>
  </div>
</div>

<!-- Memory Visualization -->
<div class="rounded-xl border border-grid-700/40 bg-grid-850 p-6 mb-10">
  <h2 class="font-display text-lg font-semibold text-slate-200 mb-4">Memory Comparison &mdash; {{ demo.instance_count }} Instances</h2>
  <div class="space-y-4">
    <div>
      <div class="flex items-center justify-between text-sm mb-1.5">
        <span class="font-mono text-grid-accent">WarpGrid (Wasm)</span>
        <span class="font-mono text-slate-400">{% if demo.is_deployed %}{{ demo.live_total_memory }}{% else %}{{ demo.wasm_memory_display }}{% endif %}</span>
      </div>
      <div class="h-4 rounded-full bg-grid-800 overflow-hidden">
        <div class="h-full rounded-full bg-gradient-to-r from-grid-accent/80 to-grid-accent progress-bar" style="width: {{ demo.wasm_bar_percent }}%"></div>
      </div>
    </div>
    <div>
      <div class="flex items-center justify-between text-sm mb-1.5">
        <span class="font-mono text-slate-400">Docker Containers</span>
        <span class="font-mono text-slate-400">{{ demo.docker_memory_display }}</span>
      </div>
      <div class="h-4 rounded-full bg-grid-800 overflow-hidden">
        <div class="h-full rounded-full bg-gradient-to-r from-slate-500/80 to-slate-400 progress-bar" style="width: 100%"></div>
      </div>
    </div>
  </div>
</div>

{% if demo.is_deployed %}
<!-- Live Metrics -->
<div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-10">
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Active Instances</span>
    <div class="text-2xl font-display font-bold text-emerald-400 mt-2">{{ demo.live_instance_count }}</div>
  </div>
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">RPS</span>
    <div class="text-2xl font-display font-bold text-grid-info mt-2">{{ demo.live_rps }}</div>
  </div>
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Latency P50</span>
    <div class="text-2xl font-display font-bold text-grid-warn mt-2">{{ demo.live_latency_p50 }}</div>
  </div>
  <div class="rounded-xl border border-grid-700/40 bg-grid-850 p-5">
    <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Error Rate</span>
    <div class="text-2xl font-display font-bold text-emerald-400 mt-2">{{ demo.live_error_rate }}</div>
  </div>
</div>
{% endif %}
